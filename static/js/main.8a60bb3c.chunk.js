(this.webpackJsonpballoons=this.webpackJsonpballoons||[]).push([[0],{12:function(t,e,n){},13:function(t,e,n){},15:function(t,e,n){"use strict";n.r(e);var o,i=n(1),a=n.n(i),r=n(7),c=n.n(r),s=(n(12),n(4));n(13);!function(t){t[t.START_MODELING=0]="START_MODELING",t[t.PAUSE_MODELING=1]="PAUSE_MODELING",t[t.STOP_MODELING=2]="STOP_MODELING",t[t.CHANGE_INITIAL_CONDITIONS=3]="CHANGE_INITIAL_CONDITIONS"}(o||(o={}));var u=function(t,e){return{type:t,payload:e}},h=n(2),l=n(3),b=n(5),d=function t(e,n){Object(l.a)(this,t),this.x=void 0,this.y=void 0,this.x=e,this.y=n},f=.02,y=function(){function t(e,n){Object(l.a)(this,t),this._rate=2500,this._KD=65,this.startPoint=void 0,this.endPoint=void 0,this.defaultLength=void 0,this.normal=void 0,this.startPoint=e,this.endPoint=n,this.defaultLength=this.getLength(),this.normal=this.getNormalVector()}return Object(b.a)(t,[{key:"getLength",value:function(){return Math.sqrt(Math.pow(this.startPoint.x-this.endPoint.x,2)+Math.pow(this.startPoint.y-this.endPoint.y,2))}},{key:"getSpringForce",value:function(){var t=this.startPoint.getVelocity(),e=this.endPoint.getVelocity(),n=(new d(t.x-e.x,t.y-e.y),this.getLength()),o=(n-this.defaultLength)*this._rate;return new d((this.startPoint.x-this.endPoint.x)/n*o,(this.startPoint.y-this.endPoint.y)/n*o)}},{key:"getNormalVector",value:function(){var t=this.getLength();return new d(-(this.startPoint.y-this.endPoint.y)/t,(this.startPoint.x-this.endPoint.x)/t)}}]),t}(),g=function(){function t(e,n,o){Object(l.a)(this,t),this.x=void 0,this.y=void 0,this.velocity=void 0,this.force=void 0,this.spring=void 0,this.x=e,this.y=n,this.velocity=o||new d(0,0),this.force=new d(0,0),console.debug("point created")}return Object(b.a)(t,[{key:"attachSpring",value:function(t){this.spring=new y(this,t)}},{key:"setVelocity",value:function(t){this.velocity=t}},{key:"getVelocity",value:function(){return this.velocity}},{key:"getForce",value:function(){return this.force}},{key:"setForce",value:function(t){this.force=t}}]),t}(),v=function t(e,n){Object(l.a)(this,t),this.startPoint=void 0,this.endPoint=void 0,this.startPoint=e,this.endPoint=n},O=function(t,e){t.forEach((function(t){return t.setForce(new d(0,0))}));t.map((function(t){return t.spring}));var n=0;return t.forEach((function(t){var e=t.spring,n=e.getSpringForce(),o=(e.getLength(),e.startPoint.getForce()),i=e.endPoint.getForce();e.startPoint.setForce(new d(o.x-n.x,o.y-n.y)),e.endPoint.setForce(new d(i.x+n.x,i.y+n.y))})),t.forEach((function(t){var e=t.spring,o=e.getLength();e.normal=e.getNormalVector(),n+=.5*Math.abs(e.startPoint.x-e.endPoint.x)*Math.abs(e.normal.x)*o})),t.forEach((function(t){var o=t.spring,i=(o.getSpringForce(),o.getLength()),a=o.startPoint.getForce(),r=o.endPoint.getForce(),c=i*e/n;o.startPoint.setForce(new d(a.x+o.normal.x*c,a.y+o.normal.y*c)),o.endPoint.setForce(new d(r.x+o.normal.x*c,r.y+o.normal.y*c))})),t.forEach((function(t){var e=t.getForce();t.setForce(new d(e.x-function(t){var e=Math.pow(10,-10);return 24*Math.pow(1,6)*e*(-2*Math.pow(1,6)+Math.pow(t,6))/Math.pow(t,13)}(Math.abs(t.x-100)),e.y))})),t},p=n(0),x=0,P=0,j=Object(i.createContext)(null),I=function(t){var e=t.children,n=Object(i.useState)({balloonCenter:"close",pointsCount:20,balloonRadius:50}),a=Object(s.a)(n,2),r=a[0],c=a[1],u=Object(i.useState)(),l=Object(s.a)(u,2),b=l[0],y=l[1],I=Object(i.useState)({points:[],walls:[],pressure:0,TFS:0}),w=Object(s.a)(I,2),N=w[0],S=w[1];Object(i.useEffect)((function(){E()}),[r]);var E=function(){var t=[new v(new g(100,600),new g(100,100))],e=new g(350,350);switch(r.balloonCenter){case"far":e=new g(500,350);break;case"close":e=new g(100+r.balloonRadius+10,350)}for(var n=[],o=0;o<r.pointsCount;o++)n.push(new g(e.x+r.balloonRadius*Math.cos(2*o*Math.PI/r.pointsCount),e.y+r.balloonRadius*Math.sin(2*o*Math.PI/r.pointsCount),new d(-1,0))),o>=1&&(n[o-1].attachSpring(n[o]),o===r.pointsCount-1&&n[o].attachSpring(n[0]));n=O(n,N.pressure),S(Object(h.a)(Object(h.a)({},N),{},{walls:t,points:n}))},C=function(){b&&clearInterval(b)};return Object(p.jsx)(j.Provider,{value:[N,r,function(t){switch(console.debug("action ".concat(t.type)),t.type){case o.START_MODELING:y(setInterval((function(){x<150&&(x+=1.5);var t=function(t){console.debug(t);var e=[],n=t.points;n=n.map((function(t){var n=t.getVelocity(),o=t.getForce();return t.x+=n.x*f+o.x/1*.5*f*f,t.y+=n.y*f+o.y/1*.5*f*f,console.debug("x=".concat(t.x," y=").concat(t.y)),e.push(new d(n.x+o.x/1*.5*f,n.y+o.y/1*.5*f)),t})),n=O(n,t.pressure);for(var o=0;o<n.length;o++){var i=n[o].getForce();n[o].setVelocity(new d(e[o].x+.5*i.x/1*f,e[o].y+.5*i.y/1*f))}var a=n[0].getVelocity();return console.debug("velocity x = ".concat(a.x,", y=").concat(a.y)),n}(Object(h.a)(Object(h.a)({},N),{},{pressure:x}));P+=f,S(Object(h.a)(Object(h.a)({},N),{},{points:t,TFS:P}))}),f));break;case o.PAUSE_MODELING:C();break;case o.STOP_MODELING:C(),E();break;case o.CHANGE_INITIAL_CONDITIONS:C();var e=Object(h.a)(Object(h.a)({},r),t.payload);(n=e).balloonRadius<25||n.balloonRadius>100||n.pointsCount<5||n.pointsCount>50||c(e)}var n}],children:e})},w=700,N=700;var S=function(){var t=Object(i.useContext)(j),e=Object(s.a)(t,3),n=e[0],a=e[1],r=e[2],c=Object(i.useRef)(null),h=function(t){return function(){return t(c.current.getContext("2d"))}},l=h((function(t){n.points.forEach((function(e){t.beginPath(),t.moveTo(e.x,e.y),t.arc(e.x,e.y,5,0,2*Math.PI,!1),t.fillStyle="green",t.fill(),t.strokeStyle="blue";var n=e.spring;t.moveTo(n.startPoint.x,n.startPoint.y),t.lineTo(n.endPoint.x,n.endPoint.y),t.stroke(),t.closePath()}))})),b=h((function(t){n.walls.forEach((function(e){t.beginPath(),t.strokeStyle="black",t.moveTo(e.startPoint.x,e.startPoint.y),t.lineTo(e.endPoint.x,e.endPoint.y),t.stroke(),t.closePath()}))})),d=h((function(t){t.clearRect(0,0,w,N)}));return Object(i.useEffect)((function(){d(),l(),b()}),[n]),Object(p.jsxs)("div",{className:"App",children:[Object(p.jsx)("canvas",{ref:c,width:w,height:N}),Object(p.jsxs)("div",{className:"controls",children:[Object(p.jsx)("button",{onClick:function(){return r(u(o.START_MODELING))},children:"Start"}),Object(p.jsx)("button",{onClick:function(){return r(u(o.PAUSE_MODELING))},children:"Pause"}),Object(p.jsx)("button",{onClick:function(){return r(u(o.STOP_MODELING))},children:"Stop"}),Object(p.jsx)("span",{children:"Particles count:"}),Object(p.jsx)("input",{type:"number",value:a.pointsCount,min:5,max:50,onChange:function(t){r(u(o.CHANGE_INITIAL_CONDITIONS,{pointsCount:t.target.value})),console.debug(t.target.value)}}),Object(p.jsx)("span",{children:"Radius:"}),Object(p.jsx)("input",{type:"number",value:a.balloonRadius,min:25,max:100,onChange:function(t){r(u(o.CHANGE_INITIAL_CONDITIONS,{balloonRadius:parseInt(t.target.value)}))}})]})]})};c.a.render(Object(p.jsx)(a.a.StrictMode,{children:Object(p.jsx)(I,{children:Object(p.jsx)(S,{})})}),document.getElementById("root"))}},[[15,1,2]]]);
//# sourceMappingURL=main.8a60bb3c.chunk.js.map